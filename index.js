(function(){"use strict";function l(s,t,e,i,o,a,r,c){var n=typeof s=="function"?s.options:s;return t&&(n.render=t,n.staticRenderFns=e,n._compiled=!0),{exports:s,options:n}}const b={extends:"k-field",props:{value:String,emptyText:{type:String,default:"Add Apple Music embed..."},format:{type:String,default:"embed"}},computed:{hasContent(){return this.value&&this.value.trim()!==""},previewHtml(){if(!this.value)return"";if(this.format==="embed")return this.value;if(this.format==="link"){const s=this.transformLinkToEmbedSrc(this.value);return s?`<iframe allow="autoplay *; encrypted-media *;" frameborder="0" height="150" style="width:100%;overflow:hidden;background:transparent;" sandbox="allow-forms allow-popups allow-same-origin allow-scripts allow-storage-access-by-user-activation allow-top-navigation-by-user-activation" src="${s}"></iframe>`:""}return""}},methods:{transformLinkToEmbedSrc(s){return!s||typeof s!="string"||!s.startsWith("https://music.apple.com")?"":s.replace(/^https:\/\/music\.apple\.com/,"https://embed.music.apple.com")},handleSubmit(s){const t=s[this.name];if(!(this.format==="embed"?typeof t=="string"&&t.includes("<iframe")&&t.includes("embed.music.apple.com"):this.format==="link"?typeof t=="string"&&t.startsWith("https://music.apple.com/"):!1)){this.$panel.notification.error({message:this.format==="link"?"Enter a valid link (e.g. https://music.apple.com/...)":"Valid Apple Music embed not found.",timeout:4e3});return}Promise.resolve().then(()=>{this.$emit("input",t),this.$emit("change",t),this.closeDrawer(),this.$panel.notification.success({message:"Ok",timeout:4e3})}).catch(()=>{this.$panel.notification.error({message:"An error occurred",timeout:4e3})})},openDrawer(){const s={label:this.format==="link"?"Apple Music URL":"Embed Code",type:this.format==="link"?"url":"textarea",icon:this.icon==="link"?"link":"code",spellcheck:!1,autofocus:!0,help:this.help||(this.format==="link"?"Paste an Apple Music URL like https://music.apple.com...":"Paste the embed code (iframe) for a album, song, or playlist from Apple Music.")};this.format!=="link"&&(s.font="monospace",s.buttons=!1,s.size="medium",s.validate=t=>typeof t=="string"&&t.includes("<iframe")&&t.includes("embed.music.apple.com")||"Please paste valid Apple Music embed code."),this.$panel.drawer.open({component:"k-form-drawer",props:{icon:"album",title:this.label||"Apple Music Embed",value:{[this.name]:this.value},fields:{[this.name]:s}},on:{submit:this.handleSubmit.bind(this)}})},closeDrawer(){this.$panel.drawer.close()}}};var w=function(){var t=this,e=t._self._c;return e("k-field",t._b({staticClass:"k-applemusic-field"},"k-field",t.$props,!1),[e("k-button",{attrs:{slot:"options",icon:"edit-line",size:"xs",variant:"filled"},on:{click:t.openDrawer},slot:"options"},[t._v("Edit...")]),t.hasContent?t._e():e("div",{staticClass:"k-applemusic-empty"},[e("k-grid",{staticStyle:{"--columns":"1",gap:"0.5rem"}},[e("k-empty",{attrs:{text:t.emptyText,icon:"album"},on:{click:t.openDrawer}})],1)],1),e("div",{staticClass:"k-applemusic-preview",domProps:{innerHTML:t._s(t.previewHtml)}})],1)},k=[],_=l(b,w,k);const y=_.exports,C={created(){var s;console.log("[AppleMusicBlock] format:",this.format),console.log("[AppleMusicBlock] value:",(s=this.content)==null?void 0:s.apple_music)},computed:{hasContent(){var s,t;return((t=(s=this.content)==null?void 0:s.apple_music)==null?void 0:t.length)>0},format(){var t;const s=(t=this.content)==null?void 0:t.format;return typeof s=="string"?s:s===!0?"link":"embed"},hasErrors(){var t;const s=((t=this.content)==null?void 0:t.apple_music)||"";return s?this.format==="embed"?!s.includes("<iframe"):this.format==="link"?!/^https:\/\/music\.apple\.com\/.+/.test(s):!0:!1},previewHtml(){var t;const s=((t=this.content)==null?void 0:t.apple_music)||"";return s?this.format==="embed"?s:this.format==="link"?`<iframe 
					allow="autoplay *; encrypted-media *;" 
					frameborder="0" 
					height="150" 
					style="width:100%;overflow:hidden;background:transparent;" 
					sandbox="allow-forms allow-popups allow-same-origin allow-scripts allow-storage-access-by-user-activation allow-top-navigation-by-user-activation" 
					src="${s.replace(/^https:\/\/music\.apple\.com/,"https://embed.music.apple.com")}"></iframe>`:"":""}}};var M=function(){var t=this,e=t._self._c;return e("div",{staticClass:"k-applemusic-preview"},[t.hasContent&&!t.hasErrors?[e("k-html-field-preview",{attrs:{value:t.previewHtml}})]:t.hasErrors?[e("k-grid",{staticStyle:{"--columns":"1",gap:"0.5rem"}},[e("k-box",{attrs:{theme:"warning",icon:"alert",text:`Invalid Apple Music ${t.format==="embed"?"embed":"link"}`}})],1)]:[e("k-empty",{attrs:{icon:"album",text:"Add an Apple Music embed..."}})]],2)},S=[],x=l(C,M,S);const T=x.exports,$={name:"Configure Apple Music",props:{appName:String,appBuild:String,hasToken:Boolean,status:String,missing:Array,errors:Array},data(){return{loading:!0,busy:!1,localStatus:this.status??null,localMissing:this.missing??[],localErrors:this.errors??[]}},computed:{emptyText(){return this.localStatus==="unconfigured"?"Apple Music is not fully configured yet":"Invalid Apple Music configuration"}},async created(){try{const t=await(await fetch(`${window.location.origin}/applemusic/config-status`,{credentials:"same-origin",headers:{Accept:"application/json"}})).json();this.localStatus=t.status,this.localMissing=t.missing||[],this.localErrors=t.errors||[]}finally{this.loading=!1}},methods:{redirectAuth(){},reload(){this.$reload()}}};var L=function(){var t=this,e=t._self._c;return e("k-panel-inside",[e("k-view",{staticClass:"k-musickit-config-view"},[e("k-header",{staticClass:"k-site-view-header"},[t._v(" Configure Apple Music "),e("k-button-group",{attrs:{slot:"buttons"},slot:"buttons"},[e("k-button",{attrs:{variant:"filled",theme:"blue-icon",icon:"document",size:"xs",link:"https://github.com/scottboms/kirby-applemusic/blob/main/README.md",target:"_blank",responsive:"true",text:"Setup Guide"}})],1)],1),t.loading?e("k-box",{attrs:{icon:"loader"}},[t._v("Checking configuration...")]):e("k-box",{attrs:{icon:"settings",text:t.emptyText,theme:"warning"}}),!t.loading&&t.localStatus!=="ok"?e("k-grid",{staticStyle:{"--columns":"1",gap:"0"}},[e("k-box",{staticStyle:{"margin-top":"var(--spacing-2)"},attrs:{theme:"text"}},[e("k-text",{attrs:{theme:"text"}},[e("h1",[t._v("Errors")]),e("ul",[t.localMissing.length?e("li",[t._v("Missing required configuration settings — "),e("strong",[t._v(t._s(t.localMissing.join(", ")))])]):t._e(),t._l(t.localErrors,function(i){return e("li",{key:i},[t._v(t._s(i))])})],2),e("p",[t._v("Correct these settings in "),e("code",[t._v("env.php")]),t._v(" under "),e("code",[t._v("scottboms.applemusic.*")]),t._v(". Review the Setup Guide for further information.")])])],1)],1):t._e()],1)],1)},A=[],Z=l($,L,A);const I=Z.exports;function m({url:s,onCopy:t,onEmbed:e,onError:i}){return s?[{icon:"headphones",text:"Listen",click:()=>window.open(s,"_blank")},"-",{icon:"url",text:"Copy Link",click:()=>t==null?void 0:t(s)},{icon:"code",text:"Embed Code",click:()=>{try{const o=e==null?void 0:e(s);if(!o)throw new Error("No embed");t==null||t(o,"Embed copied to clipboard")}catch{i==null||i("Could not create embed code")}}}]:[]}const R={name:"Apple Music",props:{appName:String,appBuild:String,hasToken:Boolean,storefront:String,songsLimit:{type:Number,default:15}},data(){return{busy:!1,msg:this.hasToken?"Token saved.":"Not connected yet.",items:[],loading:!1,error:null,limit:this.songsLimit,offset:0,language:"en-US",storefrontInfo:null,searchQuery:"",searchType:"songs",searchResults:[],searching:!1,searchError:null,searchLimit:10,_searchTimer:null}},created(){this.hasToken&&(this.fetchStorefront(),this.fetchRecent())},watch:{hasToken(s){s?(this.fetchStorefront(),this.fetchRecent()):(this.items=[],this.error=null,this.loading=!1,this.storefrontInfo=null,this.searchQuery="",this.searchResults=[],this.searching=!1,this.searchError=null)}},computed:{headerTitle(){return this.hasToken?"Apple Music":"Authorize Apple Music"},searchResultItems(){var i;const s=(((i=this.storefrontInfo)==null?void 0:i.id)||this.storefront||"us").toString().toLowerCase(),t=s==="auto"?"us":s,e=this.$urls&&this.$urls.panel?this.$urls.panel:"/panel";return(this.searchResults||[]).map(o=>{const{id:a,kind:r,image:c,text:n,info:Y,link:d}=o||{},p=r==="albums"||r==="album",f=p?"album":"song",g=a?`https://music.apple.com/${t}/${f}/${encodeURIComponent(a)}`:null,h={id:a,text:n,info:Y,icon:p?"album":"music",...c?{image:{src:c,ratio:"1/1",cover:!0,back:"pattern"}}:{}};if(d?h.link=d:a&&(h.link=`${e}/applemusic/${f}/${encodeURIComponent(a)}`),g){const v=m({url:g,onCopy:(u,J="Link copied to clipboard")=>this.copyToClipboard(u,J),onEmbed:u=>this.buildEmbedCode(u),onError:u=>this.notify("error",u)});v.length&&(h.options=v)}return h})},searchTypeOptions(){return[{value:"songs",text:"Songs"},{value:"albums",text:"Albums"}]},collectionItems(){return(this.items||[]).map(s=>{const t=this.trackUrl(s),e=typeof s.id=="string"&&s.id.startsWith("i."),i={id:s.id,text:this.trackTitle(s),info:this.artistName(s),image:{src:this.artworkUrl(s,300)||void 0,ratio:"1/1",cover:!0,back:"pattern"},icon:"music",title:this.trackSubtitle(s),...e?{}:{link:"applemusic/song/"+s.id}};if(t){const o=m({url:t,onCopy:(a,r="Link copied to clipboard")=>this.copyToClipboard(a,r),onEmbed:a=>this.buildEmbedCode(a),onError:a=>this.notify("error",a)});o.length&&(i.options=o)}return i})},statReports(){const s=[{label:"Version "+this.appBuild,value:this.appName,icon:"layers",info:"Build Info",theme:"info"}];return this.storefrontInfo&&s.push({label:"Storefront",value:this.storefrontInfo.id,icon:"store",info:this.storefrontInfo.language,theme:this.storefrontInfo.id?"positive":"warning"}),s}},mounted(){(async()=>{try{await this.loadMusicKit(this.cspNonce);const s=await fetch("/applemusic/dev-token",{credentials:"same-origin"});if(!s.ok)throw new Error("dev-token "+s.status);const{token:t}=await s.json(),e=(this.storefront||"auto").toLowerCase(),i={developerToken:t,app:{name:this.appName||"KirbyMusicKit",build:this.appBuild||"2.0.0"}};e!=="auto"&&(i.storefrontId=e),window.MusicKit.configure(i)}catch{this.notify("error","Failed to prepare Apple Music (CSP/network/dev token)")}})(),(async()=>{try{const s=await fetch("/applemusic/has-token",{credentials:"same-origin"});if(s.ok){const{hasToken:t}=await s.json();this.hasToken=!!t}}catch(s){console.warn("has-token check failed:",s)}})();try{const s=new URL(window.location.href);s.searchParams.get("connected")==="1"&&(this.notify("success","Connected — token saved."),s.searchParams.delete("connected"),window.history.replaceState({},"",s.toString()))}catch{}},methods:{onSearchInput(s){if(this.searchQuery=s||"",clearTimeout(this._searchTimer),!this.searchQuery.trim()){this.searchResults=[],this.searchError=null;return}this._searchTimer=setTimeout(()=>this.performSearch(this.searchQuery),400)},async performSearch(s){var e;const t=(typeof s=="string"?s:this.searchQuery).trim();if(t)try{this.searching=!0,this.searchError=null;const i=(((e=this.storefrontInfo)==null?void 0:e.id)||this.storefront||"us").toString().toLowerCase(),o=i==="auto"?"us":i,r=`/applemusic/search?${new URLSearchParams({q:t,limit:String(this.searchLimit),language:this.language,sf:o,type:this.searchType}).toString()}`,c=await fetch(r,{credentials:"same-origin"}),n=await c.json();if(!c.ok||!n.ok)throw new Error((n==null?void 0:n.error)||`HTTP ${c.status}`);this.searchResults=n.results}catch(i){this.searchResults=[],this.searchError=(i==null?void 0:i.message)||"Search failed",this.notify("error",this.searchError)}finally{this.searching=!1}},onSearchTypeChange(s){var t;this.searchType=s||"songs",(t=this.searchQuery)!=null&&t.trim()&&this.performSearch()},async copyToClipboard(s,t="Copied"){var e;try{if(!s)throw new Error("Nothing to copy");if((e=navigator.clipboard)!=null&&e.writeText)await navigator.clipboard.writeText(s);else{const i=document.createElement("textarea");i.value=s,i.setAttribute("readonly",""),i.style.position="fixed",i.style.opacity="0",document.body.appendChild(i),i.select(),document.execCommand("copy"),document.body.removeChild(i)}this.notify("success",t)}catch(i){console.warn("copyToClipboard failed:",i),this.notify("error","Could not copy to clipboard")}},toEmbedUrl(s){var t;try{const e=new URL(s);if(!/apple\.com$/i.test(e.hostname))return null;e.hostname="embed.music.apple.com";const i=e.pathname.split("/").filter(Boolean);if(!(i.length>0&&/^[a-z]{2}$/i.test(i[0]))){const a=(((t=this.storefrontInfo)==null?void 0:t.id)||this.storefront||"us").toString().toLowerCase();i.unshift(a),e.pathname="/"+i.join("/")}return e.toString()}catch{return null}},buildEmbedCode(s){const t=this.toEmbedUrl(s);return t?`<iframe allow="autoplay *; encrypted-media *;" frameborder="0" height="150" style="width:100%;overflow:hidden;background:transparent;" sandbox="allow-forms allow-popups allow-same-origin allow-scripts allow-storage-access-by-user-activation allow-top-navigation-by-user-activation" src="${t}"></iframe>`:null},async loadMusicKit(s){var t,e;(t=window.MusicKit)!=null&&t.getInstance||(document.querySelector("script[data-am-mk]")?(e=window.MusicKit)!=null&&e.getInstance||await new Promise(i=>{window.addEventListener("musickitloaded",i,{once:!0}),setTimeout(i,50)}):await new Promise((i,o)=>{const a=document.createElement("script");a.src="https://js-cdn.music.apple.com/musickit/v3/musickit.js",a.async=!0,a.dataset.amMk="1",s&&a.setAttribute("nonce",s),a.onerror=o,document.head.appendChild(a);let r=!1,c=!1;const n=()=>{r&&c&&i()};a.onload=()=>{r=!0,n()},window.addEventListener("musickitloaded",()=>{c=!0,n()},{once:!0})}))},async redirectAuth(){try{this.busy=!0,this.notify("info","Redirecting to Apple Music sign-in…");const s=(this.storefront||"auto").toLowerCase(),t=window.location.href,e=`/applemusic/auth?sf=${encodeURIComponent(s)}&returnTo=${encodeURIComponent(t)}`;window.location.assign(e)}catch{this.notify("error","Could not start sign-in")}},async popupAuth(){try{this.busy=!0,this.notify("info","Opening Apple Music…");const s=(this.storefront||"").toLowerCase(),t=s?`/applemusic/auth?sf=${encodeURIComponent(s)}`:"/musickit/auth",e=window.open(t,"amPopup","width=480,height=600"),i=async o=>{if(o.origin!==window.location.origin)return;const a=o.data||{};if(a.type==="musickit-token"){window.removeEventListener("message",i),a.ok?(this.notify("success","Connected — token saved"),this.hasToken=!0):(console.error("Popup failed:",a.error,a.detail||""),this.notify("warning","Authorization cancelled or failed"));try{e&&e.close()}catch{}this.busy=!1}};window.addEventListener("message",i),setTimeout(()=>{try{(!e||e.closed)&&(window.removeEventListener("message",i),this.busy=!1,this.notify("info","Popup closed"))}catch{}},6e4)}catch(s){console.error("popupAuth error:",s),this.notify("error","Could not open popup"),this.busy=!1}},async refreshDevToken(){var s,t;try{const e=await fetch("/applemusic/dev-token/refresh",{method:"POST",credentials:"same-origin",headers:{Accept:"application/json"}});if(!e.ok){const r=await e.text();throw new Error(`HTTP ${e.status}: ${r.slice(0,200)}`)}const{token:i}=await e.json();if(!i)throw new Error("No token returned");const o=(this.storefront||"auto").toLowerCase(),a={developerToken:i,app:{name:this.appName||"KirbyMusicKit",build:this.appBuild||"dev"}};if(o&&o!=="auto"&&(a.storefrontId=o),!window.MusicKit)throw new Error("MusicKit SDK not loaded");window.MusicKit.configure(a);try{window.MusicKit.getInstance()}catch{}this.notify("success","Developer token refreshed"),this.hasToken&&((s=this.fetchStorefront)==null||s.call(this),(t=this.fetchRecent)==null||t.call(this))}catch(e){console.error("refreshDevToken failed:",e),this.notify("error",`Could not refresh dev token: ${e.message||e}`)}},async disconnect(){var s,t;try{if(!confirm("Disconnect Apple Music for this Panel user?"))return;this.busy=!0,this.notify("info","Disconnecting...");try{await this.loadMusicKit(this.cspNonce);const i=(t=(s=window.MusicKit)==null?void 0:s.getInstance)==null?void 0:t.call(s);i!=null&&i.isAuthorized&&await i.unauthorize()}catch(i){console.warn("unauthorize() skipped/failed:",i)}const e=await fetch("/applemusic/delete-user-token",{method:"POST",credentials:"same-origin"});if(!e.ok)throw new Error("delete-token "+e.status);this.hasToken=!1,this.notify("success","Disconnected — saved token removed")}catch(e){console.error("disconnect() error:",e),this.notify("error","Could not disconnect — see console for details")}finally{this.busy=!1}},async fetchStorefront(){var s,t;try{const e=new URLSearchParams({language:this.language}).toString(),i=await fetch(`/applemusic/storefront?${e}`,{credentials:"same-origin"});if(!i.ok)throw new Error("storefront "+i.status);const o=await i.json(),a=((s=o==null?void 0:o.data)==null?void 0:s[0])||{};this.storefrontInfo={id:a.id||null,language:((t=a.attributes)==null?void 0:t.defaultLanguageTag)||null}}catch{this.storefrontInfo=null,this.notify("info","Could not load storefront")}},async fetchRecent(s={}){this.loading=!0,this.error=null;const t={limit:s.limit??this.limit,offset:s.offset??this.offset,language:this.language};try{const e=new URLSearchParams({limit:String(t.limit),offset:String(t.offset),language:t.language}).toString(),o=await(await fetch(`/applemusic/recent?${e}`,{credentials:"same-origin"})).json();this.items=Array.isArray(o==null?void 0:o.data)?o.data:[],this.limit=t.limit,this.offset=t.offset}catch(e){this.error=(e==null?void 0:e.message)||"Failed to load recently played tracks"}finally{this.loading=!1}},nextPage(){this.fetchRecent({offset:this.offset+this.limit})},prevPage(){this.fetchRecent({offset:Math.max(0,this.offset-this.limit)})},artworkUrl(s,t=100){var i;const e=(i=s==null?void 0:s.attributes)==null?void 0:i.artwork;return e!=null&&e.url?e.url.replace("{w}",t).replace("{h}",t):null},trackTitle(s){var t;return((t=s==null?void 0:s.attributes)==null?void 0:t.name)||"Untitled"},trackSubtitle(s){var i,o;const t=(i=s==null?void 0:s.attributes)==null?void 0:i.artistName,e=(o=s==null?void 0:s.attributes)==null?void 0:o.albumName;return[t,e].filter(Boolean).join(" — ")},artistName(s){var t;return(t=s==null?void 0:s.attributes)==null?void 0:t.artistName},albumName(s){var t;return((t=s==null?void 0:s.attributes)==null?void 0:t.albumName)||"Untitled"},trackUrl(s){var t;return((t=s==null?void 0:s.attributes)==null?void 0:t.url)||null},notify(s,t){var i;const e=this.$panel||((i=this.$root)==null?void 0:i.$panel);if(e!=null&&e.notification){if(typeof e.notification[s]=="function"){e.notification[s](t);return}if(typeof e.notification.create=="function"){e.notification.create({message:t,type:s});return}}console[s==="error"?"error":"log"](`[${s}] ${t}`)}}};var E=function(){var t=this,e=t._self._c;return e("k-panel-inside",[e("k-view",{staticClass:"k-musickit-auth"},[e("k-header",{staticClass:"k-site-view-header"},[t._v(" "+t._s(t.headerTitle)+" "),e("k-button-group",{attrs:{slot:"buttons"},slot:"buttons"},[e("k-button",{attrs:{variant:"filled",theme:"blue-icon",icon:"document",size:"xs",link:"https://github.com/scottboms/kirby-applemusic/blob/main/README.md",target:"_blank",responsive:"true",text:"Setup Guide"}}),t.hasToken?t._e():e("k-button",{attrs:{disabled:t.busy,variant:"filled",theme:"green-icon",icon:"open",size:"xs"},on:{click:t.redirectAuth}},[t._v(" "+t._s(t.hasToken?"Re-authorize Apple Music":"Authorize Apple Music")+" ")]),t.hasToken?e("k-button",{attrs:{disabled:t.busy,variant:"filled",icon:"reset-token",text:"Reset Token",size:"xs",title:"Reset the Cached Token"},on:{click:t.refreshDevToken}}):t._e(),t.hasToken?e("k-button",{attrs:{disabled:t.busy,variant:"filled",theme:"red-icon",icon:"logout",text:"Disconnect",size:"xs",title:"Delete the Saved Token"},on:{click:t.disconnect}}):t._e()],1)],1),t.hasToken?t._e():e("k-box",{staticStyle:{"margin-bottom":".5rem"},attrs:{theme:"positive",icon:"settings"}},[t._v(" Your configuration is ready to connect to your Apple Music account. ")]),e("k-section",[e("k-stats",{staticClass:"k-musickit-info-reports",attrs:{reports:t.statReports,size:"small"}})],1),t.hasToken?[e("k-section",[e("k-box",{staticStyle:{"margin-bottom":"var(--spacing-1)"},attrs:{icon:"search",theme:"white"}},[e("k-select-field",{staticStyle:{"min-width":"9rem"},attrs:{value:t.searchType,options:t.searchTypeOptions,disabled:!t.hasToken,icon:"angle-down",size:"tiny"},on:{input:t.onSearchTypeChange}}),e("k-search-input",{staticStyle:{"min-width":"80%"},attrs:{value:t.searchQuery,disabled:!t.hasToken,autofocus:!0,placeholder:"Search Apple Music..."},on:{input:t.onSearchInput,submit:t.performSearch}})],1),t.searching?e("k-box",{staticStyle:{"--width":"100%"},attrs:{icon:"loader"}},[t._v("Searching...")]):t.searchResults.length?e("k-items",{attrs:{items:t.searchResultItems,layout:"list",size:"small"}}):t.searchQuery&&!t.searching?e("k-box",{attrs:{theme:"none"}},[t._v("No matches found")]):t._e()],1),e("k-section",{attrs:{label:"Recently Played Tracks"}},[e("k-button",{attrs:{slot:"options",size:"xs",variant:"filled",icon:"refresh"},on:{click:function(i){return t.fetchRecent()}},slot:"options"}),t.error?e("k-box",{attrs:{theme:"negative"}},[t._v(t._s(t.error))]):t.loading?e("k-box",{attrs:{icon:"loader"}},[t._v("Loading...")]):e("div",[e("k-collection",{attrs:{items:t.collectionItems,layout:"cards",size:"large"}}),t.items.length===0?e("div",[t._v(" No items returned. ")]):t._e()],1),e("k-box",{staticStyle:{"margin-top":"1rem"},attrs:{theme:"none"}},[e("k-button-group",{attrs:{responsive:"true",theme:"gray-icon"}},[e("k-button",{attrs:{variant:"filled",size:"xs",title:"Previous Page",icon:"angle-left",disabled:t.offset<=0},on:{click:t.prevPage}}),e("k-button",{attrs:{variant:"filled",size:"xs",title:"Next Page",icon:"angle-right",disabled:t.items.length<t.limit},on:{click:t.nextPage}})],1)],1)],1)]:t._e()],2)],1)},P=[],H=l(R,E,P);const N=H.exports,U={name:"Apple Music - Song Details",props:{songId:String,language:String},data(){return{loading:!0,err:null,song:null}},async created(){try{const s=`/applemusic/song/${encodeURIComponent(this.songId)}?l=${encodeURIComponent(this.language||"en-US")}`,t=await fetch(s,{credentials:"same-origin",headers:{Accept:"application/json"}});if(!t.ok)throw new Error(`HTTP ${t.status}`);const e=await t.json();this.song=e}catch(s){this.err=(s==null?void 0:s.message)||"Failed to load song"}finally{this.loading=!1}},methods:{back(){this.$go("applemusic")}}};var V=function(){var i,o;var t=this,e=t._self._c;return e("k-panel-inside",[e("k-view",[e("k-header",{staticClass:"k-site-view-header",scopedSlots:t._u([{key:"buttons",fn:function(){var a;return[(a=t.song)!=null&&a.url?e("k-button",{attrs:{icon:"headphones",link:t.song.url,target:"_blank",theme:"blue-icon",variant:"filled"}},[t._v("Listen in Apple Music")]):t._e()]},proxy:!0}])},[t._v(" "+t._s(((i=t.song)==null?void 0:i.name)||"Song")+" ")]),t.loading?e("k-box",{attrs:{icon:"loader"}},[t._v("Loading...")]):t.err?e("k-box",{attrs:{theme:"negative",icon:"alert"}},[t._v(t._s(t.err))]):e("k-section",[e("k-grid",{staticStyle:{gap:"0","--columns":"12",background:"var(--item-color-back)","border-radius":"var(--rounded)","box-shadow":"var(--shadow)"}},[t.song.image?e("k-image-frame",{staticStyle:{"border-radius":"var(--rounded)","--width":"1/2"},attrs:{src:t.song.image,alt:t.song.name,ratio:"1/1",back:"pattern",cover:"true",icon:"music"}}):t._e(),e("k-box",{staticStyle:{"--width":"1/2"}},[e("div",{staticClass:"k-text",staticStyle:{padding:"var(--spacing-8)"}},[t.song.artistName?e("p",{staticClass:"am-songArtist"},[t._v(t._s(t.song.artistName))]):t._e(),t.song.albumName?e("p",{staticClass:"am-songAlbum"},[t._v(t._s(t.song.albumName)+" ("+t._s(t.song.releaseYear)+")")]):t._e(),t.song.duration?e("k-box",{staticClass:"am-songDuration",attrs:{icon:"clock"}},[t._v(t._s(t.song.duration))]):t._e(),t.song.previewUrl?e("k-box",[e("audio",{staticClass:"k-file-preview am-audioPreview",attrs:{src:t.song.previewUrl,controls:""}})]):t._e(),e("hr"),t.song.composerName?e("k-box",{staticClass:"am-meta am-metaSmall",attrs:{icon:"composer"}},[t._v("Written by "+t._s(t.song.composerName))]):t._e(),(o=t.song.genreNames)!=null&&o.length?e("k-box",{staticClass:"am-meta am-metaSmall",attrs:{icon:"tag"}},[t._v(t._s(t.song.genreNames.join(", ")))]):t._e(),t.song.releaseDate?e("k-box",{staticClass:"am-meta am-metaSmall",attrs:{icon:"calendar"}},[t._v(t._s(t.song.releaseDate))]):t._e()],1)])],1)],1)],1)],1)},D=[],B=l(U,V,D);const z=B.exports,F="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20668%20200'%3e%3cpath%20d='M33.53.13h569.01c19.96,0,41.38-1.65,52.75,6.79,11.72,8.71,11.59,25.66,11.59,46.35v83.51c0,13.32,1.89,30.33-1.6,41.16-7.91,24.53-30.26,21.98-61.94,21.98H58.3c-18.24,0-35.67.85-45.95-6.79C.64,184.43.76,167.44.76,146.78V60.87C.76,45.96-.4,28.41,3.96,17.71,11.62-1.08,34.12.15,33.53.13h0ZM230.69,86.34h7.45l-16.31-45.17h-7.55l-16.31,45.17h7.2l4.16-12.21h17.22l4.13,12.21h0ZM218.23,49.15l6.54,19.35h-13.65l6.57-19.35h.53ZM260.85,86.91c8.61,0,14.09-6.82,14.09-17.56s-5.48-17.59-14.15-17.59c-4.63,0-8.64,2.35-10.71,6.23h-.5v-5.63h-6.48v45.33h6.73v-16.47h.53c1.78,3.6,5.63,5.7,10.49,5.7h0ZM258.91,57.51c5.7,0,9.11,4.44,9.11,11.83s-3.41,11.8-9.14,11.8-9.17-4.54-9.17-11.8,3.54-11.83,9.2-11.83h0ZM298.64,86.91c8.61,0,14.09-6.82,14.09-17.56s-5.48-17.59-14.15-17.59c-4.63,0-8.64,2.35-10.71,6.23h-.5v-5.63h-6.48v45.33h6.73v-16.47h.53c1.79,3.6,5.64,5.7,10.49,5.7h0ZM296.7,57.51c5.7,0,9.11,4.44,9.11,11.83s-3.41,11.8-9.14,11.8-9.17-4.54-9.17-11.8,3.54-11.83,9.2-11.83h0ZM319,86.34h6.73v-47.33h-6.73v47.33h0ZM338.86,71.13h24.07v-2.32c0-10.64-5.73-17.12-15.21-17.12s-15.72,6.92-15.72,17.72,5.98,17.59,15.75,17.59c7.79,0,13.3-3.76,14.78-9.77h-6.48c-1.25,2.76-4.04,4.26-8.11,4.26-5.38,0-8.86-3.88-9.08-10.05v-.31h0ZM347.69,57.17c4.98,0,8.23,3.6,8.39,9.11h-17.22c.38-5.48,3.85-9.11,8.83-9.11h0ZM217.76,157.32c13.46,0,21.26-8.33,21.26-22.7s-7.86-22.48-21.26-22.48h-16.31v45.17h16.31ZM216.98,118.19c9.36,0,14.9,6.1,14.9,16.53s-5.45,16.56-14.9,16.56h-8.52v-33.09h8.52ZM249.08,117.25c2.35,0,4.26-1.91,4.26-4.23s-1.91-4.26-4.26-4.26-4.26,1.91-4.26,4.26,1.91,4.23,4.26,4.23h0ZM252.42,157.32v-34h-6.7v34h6.7ZM274.57,170.31c9.64,0,15.75-4.92,15.75-12.65v-34.34h-6.45v5.42h-.53c-1.91-3.69-6.01-6.01-10.71-6.01-8.7,0-14.15,6.86-14.15,17.15s5.38,16.94,14.09,16.94c4.7,0,8.45-2.04,10.52-5.73h.5v6.54c0,4.6-3.32,7.36-8.92,7.36-4.54,0-7.39-1.63-7.95-4.19h-6.89c.72,5.73,6.23,9.52,14.74,9.52h0ZM274.48,128.49c5.73,0,9.23,4.45,9.23,11.39s-3.47,11.36-9.23,11.36-9.05-4.41-9.05-11.36,3.26-11.39,9.05-11.39h0ZM301.44,117.25c2.35,0,4.26-1.91,4.26-4.23s-1.91-4.26-4.26-4.26-4.26,1.91-4.26,4.26,1.91,4.23,4.26,4.23h0ZM304.79,157.32v-34h-6.7v34h6.7ZM326.5,152c-3.35,0-4.82-1.6-4.82-5.26v-17.94h7.39v-5.38h-7.39v-8.67h-6.73v8.67h-5.41v5.38h5.41v19.56c0,6.54,2.97,9.17,10.46,9.17,1.32,0,2.57-.16,3.66-.34v-5.35c-.94.09-1.53.16-2.57.16h0ZM355.06,157.32h6.48v-23.26c0-7.14-4.82-11.39-13.37-11.39-7.73,0-13.24,3.73-13.93,9.45h6.51c.75-2.47,3.35-3.88,7.11-3.88,4.6,0,6.98,2.1,6.98,5.82v2.97l-9.23.56c-8.11.5-12.68,4.04-12.68,10.14s4.79,10.14,11.36,10.14c4.48,0,8.2-1.94,10.24-5.38h.53v4.82h0ZM354.84,141.83v2.94c0,4.38-3.76,7.7-8.83,7.7-3.66,0-6.32-1.85-6.32-5.01s2.13-4.76,6.82-5.07l8.33-.56h0ZM369.32,157.32h6.73v-47.33h-6.73v47.33h0ZM439.4,157.32h6.51v-45.17h-8.2l-14.4,35.34h-.53l-14.37-35.34h-8.2v45.17h6.51v-33.09h.44l13.24,32.28h5.32l13.24-32.28h.44v33.09h0ZM474.54,157.32h6.48v-23.26c0-7.14-4.82-11.39-13.37-11.39-7.73,0-13.24,3.73-13.93,9.45h6.51c.75-2.47,3.35-3.88,7.11-3.88,4.6,0,6.98,2.1,6.98,5.82v2.97l-9.23.56c-8.11.5-12.68,4.04-12.68,10.14s4.79,10.14,11.36,10.14c4.48,0,8.2-1.94,10.24-5.38h.53v4.82h0ZM474.32,141.83v2.94c0,4.38-3.76,7.7-8.83,7.7-3.66,0-6.32-1.85-6.32-5.01s2.13-4.76,6.82-5.07l8.33-.56h0ZM500.94,127.93c3.82,0,6.26,1.66,6.89,4.19h6.45c-.66-5.88-5.67-9.45-13.34-9.45s-13.24,4.26-13.24,10.17c0,5.04,3,7.92,9.48,9.42l5.95,1.41c3.41.81,5.01,2.19,5.01,4.32,0,2.79-2.97,4.73-7.17,4.73s-6.57-1.66-7.42-4.32h-6.73c.59,5.92,5.89,9.58,13.99,9.58s14.12-4.29,14.12-10.61c0-4.95-3.04-7.73-9.52-9.23l-5.67-1.31c-3.69-.88-5.42-2.19-5.42-4.29,0-2.76,2.85-4.6,6.6-4.6h0ZM534.85,152c-3.35,0-4.82-1.6-4.82-5.26v-17.94h7.39v-5.38h-7.39v-8.67h-6.73v8.67h-5.42v5.38h5.42v19.56c0,6.54,2.97,9.17,10.46,9.17,1.31,0,2.57-.16,3.66-.34v-5.35c-.94.09-1.53.16-2.57.16h0ZM548.39,142.11h24.07v-2.32c0-10.64-5.73-17.12-15.21-17.12s-15.72,6.92-15.72,17.72,5.98,17.59,15.75,17.59c7.79,0,13.3-3.76,14.78-9.77h-6.48c-1.25,2.76-4.04,4.26-8.11,4.26-5.38,0-8.86-3.88-9.08-10.05v-.31h0ZM557.22,128.15c4.98,0,8.23,3.6,8.39,9.11h-17.22c.38-5.48,3.85-9.11,8.83-9.11h0ZM593.86,128.93c1.19,0,3.19.22,3.76.38v-6.32c-.72-.16-2-.25-3-.25-4.45,0-8.23,2.41-9.2,5.76h-.5v-5.17h-6.48v34h6.73v-20.32c0-4.79,3.6-8.08,8.7-8.08h0ZM614.44,127.93c3.82,0,6.26,1.66,6.89,4.19h6.45c-.66-5.88-5.67-9.45-13.34-9.45s-13.24,4.26-13.24,10.17c0,5.04,3.01,7.92,9.49,9.42l5.95,1.41c3.41.81,5.01,2.19,5.01,4.32,0,2.79-2.97,4.73-7.17,4.73s-6.57-1.66-7.42-4.32h-6.73c.6,5.92,5.89,9.58,13.99,9.58s14.12-4.29,14.12-10.61c0-4.95-3.04-7.73-9.52-9.23l-5.67-1.31c-3.69-.88-5.42-2.19-5.42-4.29,0-2.76,2.85-4.6,6.6-4.6h0ZM161.83,157.83c6.53-3.09,10.28-10.27,10.28-19.69V60.44c0-11.46-5.11-20.22-13.02-22.33-8.91-2.37-18.87,2.31-26.63,12.52-2.77,3.64-18.05,24.29-32.83,44.27-13.5,18.24-27.46,37.11-31.04,41.86l-.08.11c-7.31,9.72-9.47,11.41-12.84,10.03-2.78-1.14-4.2-5.94-4.2-14.29v-37.31c0-3.13,1.33-5.64,3.55-6.72,2.03-.99,4.44-.58,6.59,1.11,2.06,1.62,3.67,2.92,5.7,4.57,2.39,1.93,5.36,4.34,10.39,8.34,2.59,2.06,6.36,1.63,8.42-.96,2.06-2.59,1.63-6.36-.96-8.42-4.99-3.97-7.94-6.36-10.31-8.28-2.07-1.68-3.71-3-5.84-4.68-5.82-4.57-13.01-5.5-19.24-2.47-6.36,3.09-10.3,9.8-10.3,17.51v37.31c0,5.64,0,20.63,11.66,25.39,5.81,2.37,11.35,1.62,16.48-2.22,3.8-2.85,7.04-7.15,10.46-11.71l.08-.11c3.61-4.8,16.96-22.84,31.09-41.94,14.76-19.94,30.02-40.57,32.74-44.14,3.64-4.79,9.24-9.46,14.01-8.19,1.34.36,4.12,3.45,4.12,10.74v77.7c0,4.53-1.28,7.84-3.42,8.85-2.52,1.19-6.85-.33-11.29-3.98-3.88-3.18-31.15-25.64-31.43-25.87-2.55-2.1-6.33-1.74-8.44.82-2.1,2.56-1.74,6.33.82,8.44.28.23,27.56,22.69,31.45,25.88,5.7,4.67,11.6,7.09,16.99,7.09,2.47,0,4.84-.51,7.03-1.54Z'%20style='fill-rule:evenodd;'/%3e%3c/svg%3e",K="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='150'%20height='90'%20viewBox='0%200%2015%209'%3e%3cpath%20fill='currentColor'%20d='M8.184,0.35C9.944,0.35%2010.703,3.296%2011.338,5.238C11.673,3.842%2011.497,3.542%2011.857,3.542C11.99,3.542%2012.126,3.633%2012.126,3.798C12.126,3.809%2012.123,3.839%2012.117,3.883L12.091,4.058C12.02,4.522%2011.845,5.494%2011.654,6.144C13.198,10.191%2014.345,4.861%2014.474,3.772C14.493,3.615%2014.612,3.542%2014.731,3.542C14.891,3.542%2015.022,3.662%2014.997,3.843C14.72,5.605%2014.295,8.35%2012.547,8.35C11.582,8.35%2011.04,7.595%2010.611,6.73C9.54,4.626%209.047,1.093%207.997,1.093C7.66,1.093%207.411,1.444%207.394,1.444C7.362,1.444%207.337,1.301%207.023,0.909C7.322,0.567%207.734,0.35%208.184,0.35ZM2.458,0.354C5.211,0.354%205.456,7.618%207.014,7.618C7.197,7.618%207.394,7.507%207.61,7.256C7.729,7.458%207.851,7.638%207.978,7.796C7.667,8.151%207.28,8.35%206.795,8.35C5.054,8.349%204.306,5.434%203.663,3.466C3.511,4.097%203.432,4.669%203.402,4.925C3.382,5.088%203.263,5.163%203.143,5.163C3.009,5.163%202.874,5.071%202.874,4.908L2.874,4.908L2.877,4.87C2.966,4.223%203.146,3.243%203.347,2.56C3.079,1.858%202.745,1.091%202.252,1.091C1.257,1.091%200.687,3.591%200.527,4.925C0.508,5.088%200.388,5.163%200.268,5.163C0.135,5.163%200,5.071%200,4.908C0,4.896%200.001,4.883%200.002,4.87C0.283,2.836%200.808,0.354%202.458,0.354ZM5.315,0.35C5.809,0.35%206.339,0.608%206.797,1.211C6.822,1.241%207.078,1.639%207.159,1.777C8.277,3.802%208.818,7.627%209.881,7.627C10.065,7.627%2010.264,7.513%2010.484,7.256C10.604,7.458%2010.726,7.638%2010.852,7.796C10.542,8.15%2010.155,8.35%209.67,8.35C6.933,8.349%206.636,1.09%205.128,1.09C4.788,1.09%204.536,1.444%204.519,1.444C4.487,1.444%204.462,1.301%204.148,0.909C4.455,0.558%204.87,0.35%205.315,0.35Z'/%3e%3c/svg%3e",j={name:"Apple Music - Album Details",props:{albumId:String,language:String},data(){return{loading:!0,err:null,album:null}},async created(){try{console.log("[AlbumView] albumId prop:",this.albumId);const s=`/applemusic/album/${encodeURIComponent(this.albumId)}?l=${encodeURIComponent(this.language||"en-US")}`;console.log("[AlbumView] fetch URL:",s);const t=await fetch(s,{credentials:"same-origin",headers:{Accept:"application/json"}});if(!t.ok)throw new Error(`HTTP ${t.status}`);const e=await t.json();this.album=e}catch(s){this.err=(s==null?void 0:s.message)||"Failed to load album"}finally{this.loading=!1}},computed:{albumTrackAsItems(){var s;return(((s=this.album)==null?void 0:s.tracks)||[]).map(t=>({text:t.name??"",info:t.duration??"",id:t.id??`${t.number}-${t.name}`}))},albumItemsColumns(){return{text:{label:"Track"},info:{label:"Duration",width:"1/8",align:"right"}}},digitalMasterSrc(){var s;return(s=this.album)!=null&&s.isDigitalMaster?F:null},masteredForItunesSrc(){var s;return(s=this.album)!=null&&s.isMasteredForItunes?K:null}},methods:{back(){this.$go("applemusic")}},watch:{masteredForItunesSrc(s){}}};var Q=function(){var i,o,a,r;var t=this,e=t._self._c;return e("k-panel-inside",[e("k-view",[e("k-header",{staticClass:"k-site-view-header",scopedSlots:t._u([{key:"buttons",fn:function(){var c;return[(c=t.album)!=null&&c.url?e("k-button",{attrs:{icon:"headphones",link:t.album.url,target:"_blank",theme:"blue-icon",variant:"filled"}},[t._v("Listen in Apple Music")]):t._e()]},proxy:!0}])},[t._v(" "+t._s(((i=t.album)==null?void 0:i.name)||"Album")+" ")]),t.loading?e("k-box",{attrs:{icon:"loader"}},[t._v("Loading...")]):t.err?e("k-box",{attrs:{theme:"negative",icon:"alert"}},[t._v(t._s(t.err))]):e("k-section",[e("k-grid",{staticStyle:{gap:"0","--columns":"12",background:"var(--item-color-back)","border-radius":"var(--rounded)","box-shadow":"var(--shadow)"}},[t.album.image?e("k-image-frame",{staticStyle:{"border-radius":"var(--rounded)","--width":"1/2"},attrs:{src:t.album.image,alt:t.album.name,ratio:"1/1",back:"pattern",cover:"true",icon:"music"}}):t._e(),e("k-box",{staticStyle:{"--width":"1/2"}},[e("div",{staticClass:"k-text",staticStyle:{padding:"var(--spacing-8)"}},[t.album.artistName?e("p",{staticClass:"am-albumArtist"},[t._v(t._s(t.album.artistName))]):t._e(),t.album.name?e("p",{staticClass:"am-albumAlbum"},[t._v(t._s(t.album.name))]):t._e(),t.album.totalDuration?e("k-box",{staticClass:"am-meta am-small",attrs:{icon:"clock"}},[t._v(t._s(t.album.totalDuration))]):t._e(),t.album.recordLabel?e("k-box",{staticClass:"am-meta am-metaSmall",attrs:{icon:"label"}},[t._v(t._s(t.album.recordLabel))]):t._e(),t.album.releaseDate||t.album.recordLabel?e("k-box",{staticClass:"am-meta am-metaSmall",attrs:{icon:"calendar"}},[t._v("Released on "+t._s(t.album.releaseDate))]):t._e(),(o=t.album)!=null&&o.digitalMasterSrc?e("div",{domProps:{innerHTML:t._s(t.dmBadge)}}):t._e(),t.digitalMasterSrc||t.masteredForItunesSrc?e("k-box",{staticClass:"am-meta am-badges"},[t.digitalMasterSrc?e("k-image-frame",{staticClass:"am-dm",staticStyle:{"--width":"auto",width:"100px",height:"40px"},attrs:{src:t.digitalMasterSrc,alt:"Digital Master",ratio:"auto"}}):t._e(),t.digitalMasterSrc?e("k-text",[t._v("Digital Master")]):t._e(),t.masteredForItunesSrc?e("k-image-frame",{staticClass:"am-mfi",staticStyle:{"--width":"auto",width:"20px",height:"20px"},attrs:{src:t.masteredForItunesSrc,alt:"Mastered for iTunes",ratio:"auto"}}):t._e(),t.masteredForItunesSrc?e("k-text",[t._v("Mastered for iTunes")]):t._e()],1):t._e()],1)])],1),(r=(a=t.album)==null?void 0:a.tracks)!=null&&r.length?e("k-items",{staticStyle:{"border-radius":"var(--rounded)","margin-top":"var(--spacing-1)"},attrs:{layout:"table",items:t.albumTrackAsItems,columns:t.albumItemsColumns}}):t._e(),t.album.copyright?e("k-box",{staticClass:"am-meta am-metaSmall am-copyright"},[t._v(t._s(t.album.copyright))]):t._e()],1)],1)],1)},q=[],O=l(j,Q,q);const W=O.exports,G={album:'<svg id="a" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17.5,5.5v9.5c0,1.38-1.12,2.5-2.5,2.5s-2.5-1.12-2.5-2.5,1.12-2.5,2.5-2.5c.17,0,.34.02.5.05v-4.65l-6,.6v7.5c0,1.38-1.12,2.5-2.5,2.5s-2.5-1.12-2.5-2.5,1.12-2.5,2.5-2.5c.17,0,.34.02.5.05v-7.05l10-1Z"/><path d="M23,20V4c0-1.66-1.34-3-3-3H4c-1.66,0-3,1.34-3,3v16c0,1.66,1.34,3,3,3h16c1.66,0,3-1.34,3-3ZM4,21c-.55,0-1-.45-1-1V4c0-.55.45-1,1-1h16c.55,0,1,.45,1,1v16c0,.55-.45,1-1,1H4Z"/></svg>',"album-filled":'<svg id="a" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17.5,5.5v9.5c0,1.38-1.12,2.5-2.5,2.5s-2.5-1.12-2.5-2.5,1.12-2.5,2.5-2.5c.17,0,.34.02.5.05v-4.65l-6,.6v7.5c0,1.38-1.12,2.5-2.5,2.5s-2.5-1.12-2.5-2.5,1.12-2.5,2.5-2.5c.17,0,.34.02.5.05v-7.05l10-1ZM23,20V4c0-1.66-1.34-3-3-3H4c-1.66,0-3,1.34-3,3v16c0,1.66,1.34,3,3,3h16c1.66,0,3-1.34,3-3Z"/></svg>',composer:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2ZM12.1597 16C10.1243 16 8.29182 16.8687 7.01276 18.2556C8.38039 19.3474 10.114 20 12 20C13.9695 20 15.7727 19.2883 17.1666 18.1081C15.8956 16.8074 14.1219 16 12.1597 16ZM12 4C7.58172 4 4 7.58172 4 12C4 13.8106 4.6015 15.4807 5.61557 16.8214C7.25639 15.0841 9.58144 14 12.1597 14C14.6441 14 16.8933 15.0066 18.5218 16.6342C19.4526 15.3267 20 13.7273 20 12C20 7.58172 16.4183 4 12 4ZM12 5C14.2091 5 16 6.79086 16 9C16 11.2091 14.2091 13 12 13C9.79086 13 8 11.2091 8 9C8 6.79086 9.79086 5 12 5ZM12 7C10.8954 7 10 7.89543 10 9C10 10.1046 10.8954 11 12 11C13.1046 11 14 10.1046 14 9C14 7.89543 13.1046 7 12 7Z"></path></svg>',"edit-line":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M5 18.89H6.41421L15.7279 9.57627L14.3137 8.16206L5 17.4758V18.89ZM21 20.89H3V16.6473L16.435 3.21231C16.8256 2.82179 17.4587 2.82179 17.8492 3.21231L20.6777 6.04074C21.0682 6.43126 21.0682 7.06443 20.6777 7.45495L9.24264 18.89H21V20.89ZM15.7279 6.74785L17.1421 8.16206L18.5563 6.74785L17.1421 5.33363L15.7279 6.74785Z"></path></svg>',headphones:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M4 12H7C8.10457 12 9 12.8954 9 14V19C9 20.1046 8.10457 21 7 21H4C2.89543 21 2 20.1046 2 19V12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12V19C22 20.1046 21.1046 21 20 21H17C15.8954 21 15 20.1046 15 19V14C15 12.8954 15.8954 12 17 12H20C20 7.58172 16.4183 4 12 4C7.58172 4 4 7.58172 4 12Z"></path></svg>',label:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M12.9998 3L12.9996 10.267L19.294 6.63397L20.294 8.36602L14.0006 11.999L20.294 15.634L19.294 17.366L12.9996 13.732L12.9998 21H10.9998L10.9996 13.732L4.70557 17.366L3.70557 15.634L9.99857 12L3.70557 8.36602L4.70557 6.63397L10.9996 10.267L10.9998 3H12.9998Z"></path></svg>',music:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M20 3V17C20 19.2091 18.2091 21 16 21C13.7909 21 12 19.2091 12 17C12 14.7909 13.7909 13 16 13C16.7286 13 17.4117 13.1948 18 13.5351V6H9V17C9 19.2091 7.20914 21 5 21C2.79086 21 1 19.2091 1 17C1 14.7909 2.79086 13 5 13C5.72857 13 6.41165 13.1948 7 13.5351V3H20Z"></path></svg>',"reset-token":'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M9 12.5 6.5 15 9 17.5 11.5 15 9 12.5ZM15 2.5C11.5724 2.5 8.76444 5.15304 8.51763 8.51763 5.15304 8.76445 2.5 11.5724 2.5 15 2.5 18.5899 5.41015 21.5 9 21.5 12.4276 21.5 15.2356 18.847 15.4824 15.4824 18.847 15.2356 21.5 12.4276 21.5 9 21.5 5.41015 18.5899 2.5 15 2.5ZM15.3234 13.4886C14.7575 11.1126 12.8874 9.24245 10.5114 8.67665 10.6772 6.34229 12.6234 4.5 15 4.5 17.4853 4.5 19.5 6.51472 19.5 9 19.5 11.3766 17.6577 13.3228 15.3234 13.4886ZM13.5 15C13.5 17.4853 11.4853 19.5 9 19.5 6.51472 19.5 4.5 17.4853 4.5 15 4.5 12.5147 6.51472 10.5 9 10.5 11.4853 10.5 13.5 12.5147 13.5 15ZM3 7C3 4.79086 4.79086 3 7 3H8.5V5H7C5.89543 5 5 5.89543 5 7V8.5H3V7ZM19 17V15.5H21V17C21 19.2091 19.2091 21 17 21H15.5V19H17C18.1046 19 19 18.1046 19 17Z"></path></svg>'};panel.plugin("scottboms/kirby-applemusic",{icons:G,components:{"k-musickit-config-view":I,"k-musickit-history-view":N,"k-musickit-song-view":z,"k-musickit-album-view":W},fields:{applemusic:y},blocks:{applemusic:T}})})();
